#!/usr/bin/env coffee

tasks = require './selenium-tasks'

argv = process.argv
if argv.length < 3
  console.log 'You need to specify a task to run'
  console.log 'Usage: ./selenium.coffee [task]\n'
  console.log 'Available tasks'

  for taskname, task of tasks
    console.log ' ', taskname
  console.log '  *'

  process.exit()

targetTask = argv[2]


webdriverio = require 'webdriverio'
options = { desiredCapabilities: { browserName: 'chrome' } }

for taskname, task of tasks
  if targetTask is not '*' then continue
  if taskname != targetTask then continue

  console.log 'Launching task:', taskname

  driver = webdriverio
      .remote(options)
      .init()

  task(driver, 'https://kme.com')